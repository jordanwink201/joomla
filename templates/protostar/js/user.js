// Tour My App JS

jQuery.event.special.tourmyapp_typing={setup:function(C,B){var A=this;jQuery(A).bind("keyup",jQuery.event.special.tourmyapp_typing.handler)},teardown:function(B){var A=this;jQuery(A).unbind("keyup",jQuery.event.special.tourmyapp_typing.handler)},handler:function(B){var C=this;var A=jQuery(C).data("typingTimer")||null;clearTimeout(A);if(B.keyCode==13){jQuery.event.special.tourmyapp_typing.doneTyping(C)}else{if(jQuery(C).val){A=setTimeout(function(){jQuery.event.special.tourmyapp_typing.doneTyping(C)},1000);jQuery(C).data("typingTimer",A)}}},doneTyping:function(A){jQuery(A).trigger("tourmyapp_typing")}};function TourMyAppSessionStorage(){}TourMyAppSessionStorage.prototype.setItem=function(C,D,E){var A;if(E){var B=new Date();B.setTime(B.getTime()+(E*24*60*60*1000));A="; expires="+B.toGMTString()}else{A=""}document.cookie=C+"="+D+A+"; path=/"};TourMyAppSessionStorage.prototype.getItem=function(B){var D=B+"=";var A=document.cookie.split(";");for(var C=0;C<A.length;C++){var E=A[C];while(E.charAt(0)==" "){E=E.substring(1,E.length)}if(E.indexOf(D)==0){return E.substring(D.length,E.length)}}return null};TourMyAppSessionStorage.prototype.removeItem=function(A){this.setItem(A,"",-1)};function TourMyAppRepository(A){this.client=A}TourMyAppRepository.prototype.getBaseUrl=function(){return this.client._getOption("url")};TourMyAppRepository.prototype.sendLogData=function(B,A,F,E,D){var C=this;jQuery.ajax({type:"get",url:C.getBaseUrl()+"/scenarios/logs/add/",dataType:"jsonp",data:{action:F,scenario_id:B,user_reference:A,step:E},success:function(G){D(G)}})};TourMyAppRepository.prototype.fetchTourDetails=function(F,E,C,B){var A=this;var D={user_reference:E};if(C){D.force=true}jQuery.ajax({url:A.getBaseUrl()+"/scenarios/"+A.client.username+"/scenario/"+F+"/",type:"GET",dataType:"jsonp",data:D,success:function(G){B(G)}})};function RepositoryCacheDecorator(A){this.cache={};this.repository=A}RepositoryCacheDecorator.prototype.getBaseUrl=function(){return this.repository.getBaseUrl()};RepositoryCacheDecorator.prototype.sendLogData=function(B,A,E,D,C){return this.repository.sendLogData(B,A,E,D,C)};RepositoryCacheDecorator.prototype.fetchTourDetails=function(A,E,D,C){var B=this;var F=B.cache[A];if(F){return C(F)}return this.repository.fetchTourDetails(A,E,D,function(G){B.cache[A]=G;C(G)})};function TourMyAppStepConditionChecker(){}TourMyAppStepConditionChecker.prototype.createPattern=function(A){return A.replace("*","[^/]+")};TourMyAppStepConditionChecker.prototype.getCurrentUrl=function(){return window.location.href};TourMyAppStepConditionChecker.prototype.checkUrlCondition=function(F){var C=F.step_meta["condition"]["condition"];var G=F.step_meta["condition"]["url_patterns"];var E=this.getCurrentUrl();var A=null;for(var D=0;D<G.length;D++){var B=new RegExp(this.createPattern(G[D]),"gmi");A=E.match(B);if(A){break}}if(C=="match"){return !!A}else{return !!!A}};TourMyAppStepConditionChecker.prototype.isElementPresent=function(A){return jQuery(A).length>0};TourMyAppStepConditionChecker.prototype.checkDomCondition=function(D){var B=D.step_meta["condition"]["condition"];var E=D.step_meta["condition"]["dom_patterns"];var A=null;for(var C=0;C<E.length;C++){A=this.isElementPresent(E[C]);if(A){break}}if(B=="match"){return A}else{return !A}};TourMyAppStepConditionChecker.prototype.checkForStepMeta=function(A){if(!A.step_meta){return false}if(!A.step_meta["condition"]){return false}return true};TourMyAppStepConditionChecker.prototype.checkConditions=function(A){if(A.step_meta["condition"]["type"]=="url"){return this.checkUrlCondition(A)}if(A.step_meta["condition"]["type"]=="dom"){return this.checkDomCondition(A)}};TourMyAppStepConditionChecker.prototype.shouldSkipStep=function(A){if(!this.checkForStepMeta(A)){return false}if(A.step_meta["condition"]["on_condition"]!="skip"){return false}return this.checkConditions(A)};TourMyAppStepConditionChecker.prototype.shouldShowMessage=function(A){if(!this.checkForStepMeta(A)){return false}if(A.step_meta["condition"]["on_condition"]!="show_message"){return false}return this.checkConditions(A)};function TourMyAppRenderer(A){this.controller=A;this.dom=null}TourMyAppRenderer.prototype.makeLinksOpenInNewWindow=function(A){A.find("a").each(function(){jQuery(this).attr("target","_blank")})};TourMyAppRenderer.prototype.makeDom=function(B,E){var G=this.controller._getLang();var D=this.controller._getOption("url");var C=this.controller._getOption("test_mode");var F=jQuery("<div id='tourmyapp'><div class='tourmyapp cleanslate' lang='"+G+"'><div class='tourmyapp-title'><a title='End tour' href='#' class='tourmyapp-close'></a></div><div class='tourmyapp-content'>"+B+"</div><div><div class='tourmyapp-branding' style='display:none'><a href='http://tourmyapp.com?utm_source=branding' target='_blank' style='position:absolute; bottom:10px;'><img src='"+D+"/static/images/tourmyapp_powered.png'></a></div><div class='tourmyapp-toolbar'></div><div style='clear:both;'></div></div><div class='tourmyapp-pointer-border'></div><div class='tourmyapp-pointer tourmyapp-pointer-fill'></div></div></div>");if(E){var A=jQuery("<button class='tourmyapp-next_button' id='tourmyapp-nxt-button'></button>");A.html(this.controller._getString(E));F.find(".tourmyapp-toolbar").append(A)}if(C){F.find(".tourmyapp-toolbar").prepend("<span class='tourmyapp-test-mode'>[TEST MODE]</span>");F.find(".tourmyapp-test-mode").css({"font-weight":"bold","font-size":"small",padding:"2px",color:"red","margin-left":"3px",display:"inline"})}this.makeLinksOpenInNewWindow(F.find(".tourmyapp-content"));F.css({position:"absolute"}).hide();jQuery("body").append(F);return F};TourMyAppRenderer.prototype.getTopPosition=function(B,E,C,A,D){if(A=="page"){return this.getPageTopPosition(E,D)}else{return this.getWidgetTopPosition(B,E,C,D)}};TourMyAppRenderer.prototype.getPageTopPosition=function(D,C){var A=C.height();var B=window.innerHeight;if(D=="top"){return B/6}if(D=="bottom"){return B*5/6-A}if(D=="center"){return((B-100)/2)}};TourMyAppRenderer.prototype.getWidgetTopPosition=function(B,H,F,G){var D=jQuery(B).offset()["top"];if(this.isFixed(B)){var D=D-jQuery(window).scrollTop()}var C=jQuery(B).outerHeight();var A=16;var E=G.height();if(H=="top"){return D-A-E}if(H=="bottom"){return D+C+A}if(H=="center"){return D+(C/2)-(E/2)}};TourMyAppRenderer.prototype.getLeftPosition=function(B,E,C,A,D){if(A=="page"){return this.getPageLeftPosition(C,D)}else{return this.getWidgetLeftPosition(B,E,C,D)}};TourMyAppRenderer.prototype.getPageLeftPosition=function(C,D){var B=D.width();var A=jQuery("body").width();if(C=="center"){return(A-B)/2}if(C=="right"){return A*5/6-B}if(C=="left"){return A/6}};TourMyAppRenderer.prototype.getWidgetLeftPosition=function(E,K,B,G){var A=jQuery(E).offset()["left"];var J=jQuery(E).outerWidth();var F=A+(J/2);var H=30;var D=16;var C=10;var I=G.width();if(K!="center"){if(B=="center"){return F-(I/2)}if(B=="right"){return F-(H/2)-C}if(B=="left"){return(F-I)+C+(H/2)}}else{if(B=="right"){return A+J+D}if(B=="left"){return A-I-D}if(B=="center"){return A+(J/2)-(I/2)}}};TourMyAppRenderer.prototype.positionDom=function(H,D,B){var A=B.split("-")[0];var C=B.split("-")[1];var G=B.split("-")[2];var F=this.getTopPosition(D,C,G,A,H);var E=this.getLeftPosition(D,C,G,A,H);if(A=="widget"){H.find(".tourmyapp-pointer").add(H.find(".tourmyapp-pointer-border")).addClass("tourmyapp-pointer-"+C);if(G!="center"){H.find(".tourmyapp-pointer").add(H.find(".tourmyapp-pointer-border")).addClass("tourmyapp-pointer-"+G)}if(C=="center"){H.find(".tourmyapp-pointer").css("top",(H.height()/2-15));H.find(".tourmyapp-pointer-border").css("top",(H.height()/2-16))}}H.css({left:E});H.css({top:F})};TourMyAppRenderer.prototype.setStyle=function(F,C){for(var A in C){var E=C[A];for(var B in E){var D=A.replace(/:/g,".");F.find(D).css(B,E[B])}}};TourMyAppRenderer.prototype.getWindowHeight=function(){return(window.innerHeight&&window.innerHeight<jQuery(window).height())?window.innerHeight:jQuery(window).height()};TourMyAppRenderer.prototype.getWindowScrollPosition=function(){return document.documentElement.scrollTop||document.body.scrollTop};TourMyAppRenderer.prototype.getWindow=function(){return window};TourMyAppRenderer.prototype.isElementInViewPort=function(D){var B=this.getWindowScrollPosition();var C=D.offset().top;var A=this.getWindowHeight();return C>B&&(D.height()+C)<(B+A)};TourMyAppRenderer.prototype.bringToViewport=function(B){if(!this.isElementInViewPort(B)){var A=this.getWindow().innerHeight;jQuery(this.getWindow()).scrollTop(B.offset().top-(A/2))}};TourMyAppRenderer.prototype.animateDom=function(B,C){var A=this.controller.record_mode;if(A){B.show();C();return }B.fadeIn(function(){C()})};TourMyAppRenderer.prototype.renderMessageBox=function(C,F,B,A){var E=this;var G=this.makeDom(C,F);var D=this.controller.style;this.positionDom(G,B,A);jQuery(window).bind("resize.tourmyapp",function(){E.positionDom(G,B,A)});if(D){this.setStyle(G,D)}this.animateDom(G,function(){E.bringToViewport(G)});this.dom=G;if(E.isFixed(B)){E.dom.css("position","fixed")}return this.dom};TourMyAppRenderer.prototype.isFixed=function(A){if(jQuery(A).css("position")=="fixed"){return true}var B=jQuery(A).parentsUntil("body");for(var C=0;C<B.length;C++){if(jQuery(B[C]).css("position")=="fixed"){return true}}};TourMyAppRenderer.prototype.set_tour_id_and_step_class=function(A,B){this.dom.find(".tourmyapp").attr("id","tour-id-"+A).addClass("tour-step-"+B)};TourMyAppRenderer.prototype.bindDomAction=function(A,B){this.dom.find(".tourmyapp-close").click(B);if(A){this.dom.find("#tourmyapp-nxt-button").bind("click.tourmyapp",A)}};TourMyAppRenderer.prototype.close_box=function(A){jQuery(window).unbind(".tourmyapp");if(!this.dom){return }this.remove_highlight(A);this.dom.remove();this.dom=null};TourMyAppRenderer.prototype.highlight=function(A){jQuery(A).addClass("tourmyapp-selected")};TourMyAppRenderer.prototype.remove_highlight=function(A){jQuery(A).removeClass("tourmyapp-selected")};TourMyAppRenderer.prototype.displayBranding=function(){if(!this.dom){return }this.dom.find(".tourmyapp-branding").show()};TourMyAppRenderer.prototype.displayStepNumber=function(B,A){var C=this.controller._getString("Step",B,A);this.dom.find(".tourmyapp-toolbar").prepend("<span class='tourmyapp-step-index'>"+C+"</span>")};function TourMyApp(B,A){this.debug("TourMyApp::");if(typeof TourMyApp.single_instance==="undefined"){this.debug("TourMyApp::new instance created");TourMyApp.single_instance=this;this.running=false;this._options={url:"https://tour.tourmyapp.com",storage:new TourMyAppSessionStorage(),step_checker:new TourMyAppStepConditionChecker(),repository:new RepositoryCacheDecorator(new TourMyAppRepository(this)),renderer:new TourMyAppRenderer(this),display_branding:true,translations:{"default":{Next:"Next »",Step:"Step {1}/{2}",Finish:"Finish"}},is_from_extension:false,establish_presence:true,test_mode:false}}else{this.debug("TourMyApp::there is already an instance")}TourMyApp.single_instance.init(B,A);return TourMyApp.single_instance}TourMyApp.prototype.debug=function(){};TourMyApp.prototype.establishPresence=function(){jQuery("body").attr("data-tourmyapp",true)};TourMyApp.prototype.bind=function(A,B){return jQuery(this).bind(A,function(C,D){if(D){return B(this,D,C)}return B(this,{},C)})};TourMyApp.prototype.unbind=function(A){return jQuery(this).unbind(A)};TourMyApp.prototype.getHumanReadableStepNumber=function(){return this.step+1};TourMyApp.prototype.raiseJSEvent=function(A,B){return jQuery(this).trigger(A,B)};TourMyApp.prototype.init=function(B,A){this.debug("TourMyApp:: init-ing with username and options",B,A);this.setOptions(A);this.username=B;this.record_mode=false;this.custom_reference=null;this.selector_gadget=null;if(this._getOption("establish_presence")){this.establishPresence()}};TourMyApp.prototype._getOption=function(A){if(this._options[A]!==undefined){return this._options[A]}return undefined};TourMyApp.prototype.setOptions=function(B){if(B===undefined){return }if(typeof B!==typeof {}){throw"Invalid Param. setOptions requires an object."}this.debug("TourMyApp::options being set",B);for(var A in B){this._options[A]=B[A]}};TourMyApp.prototype.setUserReference=function(A){this.custom_reference=A};TourMyApp.prototype._getLang=function(){var A=this._getOption("lang");if(!A){return"default"}return A};TourMyApp.prototype._getString=function(D){var A=function(I,H){var F=I;for(var G=1;G<H.length;G++){F=F.replace("{"+G+"}",H[G])}return F};var E=this._getOption("translations");var C=this._getLang();if(!E){return D}if((!E[C])&&(!E["default"])){return D}var B=E[C]||E["default"];if((!B[D])&&(!E["default"][D])){return D}return A(B[D]||E["default"][D],arguments)};TourMyApp.prototype._getStepMessage=function(B){var C=this._getLang();var A=B.message_html[C];if(A!=undefined){return A}return B.message_html["default"]};TourMyApp.prototype._getCustomReference=function(){if(this.custom_reference){this._getOption("storage").setItem("tourmyapp_custom_reference",this.custom_reference);return this.custom_reference}if(this._getOption("storage").getItem("tourmyapp_custom_reference")){return this._getOption("storage").getItem("tourmyapp_custom_reference")}var A="user-"+Math.round(Math.random()*100000000);this._getOption("storage").setItem("tourmyapp_custom_reference",A);return A};TourMyApp.prototype.closeAllMessages=function(){jQuery(".tourmyapp").each(function(){jQuery(this).find(".tourmyapp-close").click()})};TourMyApp.prototype.getParamFromUrl=function(A,D){if(!A.search){return null}var B=A.search.split("?")[1].split("&");for(var C=0;C<B.length;C++){if(B[C].indexOf(D+"=")==0){return B[C].split("=")[1]}}return null};TourMyApp.prototype.getScenarioFromUrl=function(A){return this.getParamFromUrl(A,"tourmyapp")};TourMyApp.prototype.checkIfForcedFromTheUrl=function(A){return this.getParamFromUrl(A,"tourmyapp_force")?true:false};TourMyApp.prototype.getSelector=function(B){var A=B.selector;if(!A){A="body"}return A+":visible"};TourMyApp.prototype.next=function(){var C=this.data[this.step];var A=C.selector;var B=C.action_selector;this.goToNextStep(A,B)};TourMyApp.prototype.goToNextStep=function(A,B){var C=this._getOption("renderer");jQuery(B).unbind(".tourmyapp");C.close_box(A);this.raiseJSEvent("tour_post_step",{tour:this.scenario,step:this.getHumanReadableStepNumber()});this.next_step()};TourMyApp.prototype.bindSelectorAction=function(D){if(this.record_mode){return }var C=this;var E=D.action;var B=D.action_selector;var A=this.getSelector(D);if(E=="inform"){return }if(!B){B=A}jQuery(B).bind(E+".tourmyapp",function(){C.goToNextStep(A,B)})};TourMyApp.prototype.close=function(){var C=this.data[this.step];var A=C.selector;var B=C.action_selector;this.closeTour(A,B)};TourMyApp.prototype.closeTour=function(A,B){var C=this._getOption("renderer");jQuery(B).unbind(".tourmyapp");this.sendLog("quit",this.step);this.raiseJSEvent("tour_quit",{tour:this.scenario,step:this.getHumanReadableStepNumber()});this.finish();C.close_box(A);return false};TourMyApp.prototype.waitForElement=function(A,B,F,G){var E=this;var D=2000;G=G||10000;var C=function(){if(!G){return }setTimeout(function(){if(E.isHidden(A)){C()}else{E.showStep(B,F);return }G=G-D},D)};C()};TourMyApp.prototype.getActionSelector=function(A){return A.action_selector?A.action_selector:this.getSelector(A)};TourMyApp.prototype.getButtonText=function(C,B){var A=null;if(C=="inform"){if(!B){A="Next"}else{A="Finish"}}return A};TourMyApp.prototype.showQuickMessage=function(E,D,B,A){var C=this;var F=this._getOption("renderer");var G=function(){jQuery(B).unbind(".tourmyapp");F.close_box(B)};F.renderMessageBox(E,D,B,A);F.bindDomAction(function(){G()},function(){G()})};TourMyApp.prototype.isHidden=function(A){if(jQuery(A).length==0){return true}if(jQuery(A).css("visibility")=="hidden"){return true}if(jQuery(A).css("display")=="none"){return true}var B=jQuery(A).parentsUntil("body");for(var C=0;C<B.length;C++){if(jQuery(B[C]).css("visibility")=="hidden"){return true}if(jQuery(B[C]).css("display")=="none"){return true}}return false};TourMyApp.prototype.showStep=function(A,J){var H=this;var B=this.getSelector(A);var C=A.action;var I=this.getActionSelector(A);var F=this._getOption("renderer");this.debug(B);if(H._getOption("step_checker").shouldSkipStep(A)){H.next_step();return }var D=function(L,M){return function(){return H.closeTour(L,M)}};if(H._getOption("step_checker").shouldShowMessage(A)){var K=A.step_meta["condition"]["message"];F.renderMessageBox(K,"Okay",null,"page-center-center");F.bindDomAction(D("",""),D("",""));return }H.raiseJSEvent("tour_pre_step",{tour:H.scenario,step:H.getHumanReadableStepNumber()});if(H.isHidden(B)){H.waitForElement(B,A,J);return }F.highlight(B);var E=this.getButtonText(C,J);this.dom=F.renderMessageBox(this._getStepMessage(A),E,B,A.position||"widget-bottom-right");if((H.data)&&(H.data.length)){F.set_tour_id_and_step_class(H.scenario,H.getHumanReadableStepNumber());F.displayStepNumber(H.getHumanReadableStepNumber(),H.data.length)}if(H._getOption("display_branding")){F.displayBranding()}this.bindSelectorAction(A);var G=null;if((!this.record_mode)&&(C=="inform")){G=function(){H.goToNextStep(B,"#tourmyapp-nxt-button")}}F.bindDomAction(G,D(B,I))};TourMyApp.prototype.next_step=function(){var B=this;this.step++;this._getOption("storage").setItem("tourmyapp_step",this.step);if(this.step>=this.data.length){B.sendLog("next_step",B.step);B.sendLog("finish",B.step);B.raiseJSEvent("tour_finish",{tour:B.scenario});this.finish();return }var A=this.findIfLastStep();setTimeout(function(){B.sendLog("next_step",B.step);B.showStep(B.data[B.step],A)},100)};TourMyApp.prototype.finish=function(){this.purgeMemory()};TourMyApp.prototype.isExtentionActive=function(){return this._getOption("is_from_extension")};TourMyApp.prototype.inTestMode=function(){return this._getOption("test_mode")};TourMyApp.prototype.sendLog=function(C,B){if(this.isExtentionActive()){return }if(this.inTestMode()){return }if(this.record_mode){return }var A=this._getCustomReference();this._getOption("repository").sendLogData(this.scenario,A,C,B,function(){})};TourMyApp.prototype.getStartingStep=function(){var A=0;if(this._getOption("storage").getItem("tourmyapp_step")){A=parseInt(this._getOption("storage").getItem("tourmyapp_step"))}return A};TourMyApp.prototype.findIfLastStep=function(){var A=false;if(this.data.length-this.step==1){A=true}return A};TourMyApp.prototype.getScenarioFromStorage=function(){return this._getOption("storage").getItem("tourmyapp_scenario")};TourMyApp.prototype.checkIfForcedFromStorage=function(){return this._getOption("storage").getItem("tourmyapp_force")?true:false};TourMyApp.prototype.startTour=function(B,A){this.scenario=B;if(A){this.sendLog("start",0)}this.closeAllMessages();this.step=this.getStartingStep();if(this.step>=this.data.length){return }var C=this.findIfLastStep();this.running=true;this.showStep(this.data[this.step],C)};TourMyApp.prototype.preload=function(A){this._getOption("repository").fetchTourDetails(A,this._getCustomReference(),true,function(B){})};TourMyApp.prototype.fetchData=function(B,A,E){var D=this;var C=function(F){D.style=F.style;D.data=F.step;if(F.display_branding!==undefined){D.setOptions({display_branding:F.display_branding})}D.startTour(B,A)};this._getOption("repository").fetchTourDetails(B,this._getCustomReference(),E,function(F){C(F)})};TourMyApp.prototype.purgeMemory=function(){this._getOption("storage").removeItem("tourmyapp_step");this._getOption("storage").removeItem("tourmyapp_scenario");this._getOption("storage").removeItem("tourmyapp_force")};TourMyApp.prototype.run=function(B,E,A){var D=this;var C=true;if(A){C=false}if(C){D.raiseJSEvent("tour_start",{tour:B});D.purgeMemory()}if(E){this._getOption("storage").setItem("tourmyapp_force","true")}if(B){this._getOption("storage").setItem("tourmyapp_scenario",B);this.fetchData(B,C,E)}};TourMyApp.prototype.getHrefFromWindowObject=function(A){return A.location.href};TourMyApp.prototype.isInTourBuilder=function(E,A){var B=function(){return E===A};if(B()){return false}try{var D=this.getHrefFromWindowObject(E);if(D.indexOf(this._getOption("url"))>-1){return true}else{return false}}catch(C){return true}};TourMyApp.prototype.start=function(E,D){this.debug("TourMyApp:storage status on start",document.cookie);if(this.isInTourBuilder(window.top,window.self)){this.debug("TourMyApp:is in record mode");this.record_mode=true;return }var C=this.getScenarioFromUrl(window.location);var B=this.checkIfForcedFromTheUrl(window.location);if(C){this.debug("TourMyApp:picked scenario from url",C);this.run(C,B);return }var F=this.getScenarioFromStorage();var A=this.checkIfForcedFromStorage();if(F){this.debug("TourMyApp:picked scenario from storage",F);this.run(F,A,true);return }D=D?true:false;if(E){this.debug("picked scenario from start",E);this.run(E,D)}};function TourMyAppRecorder(A){this.tourmyapp=A}TourMyAppRecorder.prototype.postToIFrame=function(B){var A=JSON.stringify(B);window.top.postMessage(A,"*")};TourMyAppRecorder.prototype.switchToRecordMode=function(){var A=this;this.record_mode=true;this.receiveMessages();A.importCSS(A.tourmyapp._getOption("url")+"/static/utils/utils.css");A.importJS(A.tourmyapp._getOption("url")+"/static/utils/utils.js","SelectorGadget",function(){A.postToIFrame({message:"inspection_ready"})})};TourMyAppRecorder.prototype.getHrefFromWindowObject=function(A){return A.location.href};TourMyAppRecorder.prototype.isInTourBuilder=function(E,A){var B=function(){return E===A};if(B()){return false}try{var D=this.getHrefFromWindowObject(E);if(D.indexOf(this.tourmyapp._getOption("url"))>-1){return true}else{return false}}catch(C){return true}};TourMyAppRecorder.prototype.is_screen_step=function(A){return A.position.indexOf("page-")==0};TourMyAppRecorder.prototype.should_propagate_message=function(A){if((A.message=="show_step")&&(this.is_screen_step(A.step))){return false}return true};TourMyAppRecorder.prototype.receiveMessages=function(){var A=this;function B(C){var D=A.decodeMessage(C.data);if(D.message=="show_step"){A.tourmyapp.showStep(D.step)}if(D.message=="inspect_selector"){A.record_for="update_selector";A.inspectElement()}if(D.message=="inspect_action_selector"){A.record_for="update_action_selector";A.inspectElement()}if(D.message=="cancel_selector"){A.cancelElement()}if(D.message=="hide_step"){A.tourmyapp.closeAllMessages()}if(A.should_propagate_message(D)){jQuery("iframe").each(function(){this.contentWindow.postMessage(C.data,"*")})}}window.addEventListener("message",B,false)};TourMyAppRecorder.prototype.cancelElement=function(){this.selector_gadget.unbind();this.selector_gadget.setMode("browse")};TourMyAppRecorder.prototype.importJS=function(F,A,E){var D=this;var C=document.createElement("script");C.setAttribute("type","text/javascript");C.setAttribute("src",F);if(E){D.wait_for_script_load(A,E)}var B=document.getElementsByTagName("head")[0];if(B){B.appendChild(C)}else{document.body.appendChild(C)}};TourMyAppRecorder.prototype.importCSS=function(B,A,E){var D=document.createElement("link");D.setAttribute("rel","stylesheet");D.setAttribute("type","text/css");D.setAttribute("media","screen");D.setAttribute("href",B);if(E){wait_for_script_load(A,E)}var C=document.getElementsByTagName("head")[0];if(C){C.appendChild(D)}else{document.body.appendChild(D)}};TourMyAppRecorder.prototype.wait_for_script_load=function(look_for,callback){var interval=setInterval(function(){if(eval("typeof "+look_for)!="undefined"){clearInterval(interval);callback()}},50)};TourMyAppRecorder.prototype.inspectElement=function(){var A=this;A.tourmyapp.closeAllMessages();if(typeof (A.selector_gadget)=="undefined"||A.selector_gadget==null){A.selector_gadget=new SelectorGadget();A.selector_gadget.addPathChangeSubscribers(function(C){var B={message:A.record_for,selector:C};A.postToIFrame(B);A.record_for=null})}else{if(A.selector_gadget.unbound){A.selector_gadget.rebind()}}A.selector_gadget.setMode("interactive")};TourMyAppRecorder.prototype.decodeMessage=function(A){return JSON.parse(A)};

// Intialize Tour My App

  var tour;
  jQuery(document).ready(function() {
      tour = new TourMyApp("1d670fca7e06139bc489da135fe3d57a"); // REPLACE WITH YOUR ACCOUNT TOKEN
      tour.start('592f52e5bc1fbe6e3e001f0a');
  });

// Add Tour My App Widget

addWidgetScript();

function addWidgetScript() {
  let flw = document.createElement('script');
  flw.type = 'text/javascript';
  flw.src = 'https://tour.tourmyapp.com/widgets/widget/592f52e5bc1fbe6e3e001f0a/';

  return (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(flw);
}
